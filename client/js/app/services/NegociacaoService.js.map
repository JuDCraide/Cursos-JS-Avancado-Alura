{"version":3,"sources":["../../app-es6/services/NegociacaoService.js"],"names":["NegociacaoService","_http","HttpService","get","then","negociacoes","map","Negociacao","Date","objeto","data","quantidade","valor","catch","Error","Promise","all","obterNegociacoesDaSemana","obterNegociacoesDaSemanaAnterior","obterNegociacoesDaSemanaRetrasada","semanas","reduce","periodoTotal","semana","concat","negociacao","ConnectionFactory","getConnection","NegociacaoDao","connection","dao","adiciona","erro","listaTodos","apagaTodos","listaAtual","obterNegociacoes","filter","some","equals","negociacaoExistente"],"mappings":"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","file":"NegociacaoService.js","sourcesContent":["class NegociacaoService {\r\n\r\n\tconstructor() {\r\n\t\tthis._http = new HttpService();\r\n\t}\r\n\r\n\tobterNegociacoesDaSemana() {\r\n\r\n\t\treturn this._http.get('negociacoes/semana')\r\n\t\t\t.then(negociacoes => negociacoes.map(\r\n\t\t\t\tobjeto => new Negociacao(new Date(objeto.data), objeto.quantidade, objeto.valor)\r\n\t\t\t)).catch(erro => {\r\n\t\t\t\t//console.log(erro);\r\n\t\t\t\tthrow new Error('Não foi possível obter as negociações da semana do servidor.');\r\n\t\t\t});\r\n\t}\r\n\r\n\tobterNegociacoesDaSemanaAnterior() {\r\n\r\n\t\treturn this._http.get('negociacoes/anterior')\r\n\t\t\t.then(negociacoes => negociacoes.map(\r\n\t\t\t\tobjeto => new Negociacao(new Date(objeto.data), objeto.quantidade, objeto.valor)\r\n\t\t\t)).catch(erro => {\r\n\t\t\t\t//console.log(erro);\r\n\t\t\t\tthrow new Error('Não foi possível obter as negociações da semana anterior do servidor.');\r\n\t\t\t});\r\n\t}\r\n\r\n\tobterNegociacoesDaSemanaRetrasada() {\r\n\r\n\t\treturn this._http.get('negociacoes/retrasada')\r\n\t\t\t.then(negociacoes => negociacoes.map(\r\n\t\t\t\tobjeto => new Negociacao(new Date(objeto.data), objeto.quantidade, objeto.valor)\r\n\t\t\t)).catch(erro => {\r\n\t\t\t\t//console.log(erro);\r\n\t\t\t\tthrow new Error('Não foi possível obter as negociações da semana retrasada do servidor.');\r\n\t\t\t});\r\n\t}\r\n\r\n\tobterNegociacoes() {\r\n\t\treturn Promise.all([\r\n\t\t\tthis.obterNegociacoesDaSemana(),\r\n\t\t\tthis.obterNegociacoesDaSemanaAnterior(),\r\n\t\t\tthis.obterNegociacoesDaSemanaRetrasada()\r\n\t\t]).then(semanas =>\r\n\t\t\tsemanas.reduce((periodoTotal, semana) => periodoTotal.concat(semana), [])\r\n\t\t).catch(erro => {\r\n\t\t\t//console.log(erro);\r\n\t\t\tthrow new Error('Não foi possível obter as negociações do servidor.')\r\n\t\t});\r\n\t}\r\n\r\n\t\r\n\tcadastra(negociacao) {\r\n\t\treturn ConnectionFactory.getConnection()\r\n\t\t\t.then(connection => new NegociacaoDao(connection))\r\n\t\t\t.then(dao => dao.adiciona(negociacao))\r\n\t\t\t.then(() => 'Negociação incluida com sucesso')\r\n\t\t\t.catch(erro => {\r\n\t\t\t\t//console.log(erro);\r\n\t\t\t\tthrow new Error(erro);\r\n\t\t\t});\r\n\t}\r\n\r\n\tlista() {\r\n\t\treturn ConnectionFactory.getConnection()\r\n\t\t\t.then(connection => new NegociacaoDao(connection))\r\n\t\t\t.then(dao => dao.listaTodos())\r\n\t\t\t.catch(erro => {\r\n\t\t\t\t//console.log(erro);\r\n\t\t\t\tthrow new Error(erro);\r\n\t\t\t});\r\n\t}\r\n\r\n\tapaga() {\r\n\t\treturn ConnectionFactory.getConnection()\r\n\t\t\t.then(connection => new NegociacaoDao(connection))\r\n\t\t\t.then(dao => dao.apagaTodos())\r\n\t\t\t.then(() => 'Negociações apagadas com sucesso')\r\n\t\t\t.catch(erro => {\r\n\t\t\t\t//console.log(erro);\r\n\t\t\t\tthrow new Error(erro);\r\n\t\t\t});\r\n\t}\r\n\r\n\timporta(listaAtual) {\r\n\t\treturn this.obterNegociacoes()\r\n\t\t\t.then(negociacoes => negociacoes.filter(negociacao =>\r\n\t\t\t\t!listaAtual.some(negociacaoExistente => negociacao.equals(negociacaoExistente))\r\n\t\t\t)).catch(erro => {\r\n\t\t\t\t//console.log(erro);\r\n\t\t\t\tthrow new Error(erro);\r\n\t\t\t});\r\n\t}\r\n}"]}