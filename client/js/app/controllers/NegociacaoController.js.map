{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["ListaNegociacoes","Mensagem","NegociacoesView","MensagemView","NegociacaoService","DataHelper","Bind","Negociacao","NegociacaoController","$","document","querySelector","bind","_inputData","_inputQuantidade","_inputValor","_listaNegociacoes","_mensagem","_ordemAtual","_service","_init","lista","then","negociacoes","forEach","adiciona","negociacao","catch","texto","erro","setInterval","importaNegociacoes","event","preventDefault","_criaNegociacao","cadastra","mensagem","_limpaFormulario","importa","apaga","esvazia","textoParaData","value","parseInt","parseFloat","focus","coluna","inverte","ordena","a","b","negociacaoController","currentInstance"],"mappings":"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","file":"NegociacaoController.js","sourcesContent":["import {ListaNegociacoes} from '../models/ListaNegociacoes';\r\nimport {Mensagem} from '../models/Mensagem';\r\nimport {NegociacoesView} from '../views/NegociacoesView';\r\nimport {MensagemView} from '../views/MensagemView';\r\nimport {NegociacaoService} from '../services/NegociacaoService';\r\nimport {DataHelper} from '../helpers/DateHelper';\r\nimport {Bind} from '../helpers/Bind';\r\nimport {Negociacao} from '../models/Negociacao';\r\n\r\n//export class NegociacaoController {\r\nclass NegociacaoController {\r\n\tconstructor() {\r\n\r\n\t\tlet $ = document.querySelector.bind(document);\r\n\r\n\t\tthis._inputData = $('#data');\r\n\t\tthis._inputQuantidade = $('#quantidade');\r\n\t\tthis._inputValor = $('#valor');\r\n\r\n\t\tthis._listaNegociacoes = new Bind(\r\n\t\t\tnew ListaNegociacoes(),\r\n\t\t\tnew NegociacoesView($('#negociacoes-view')),\r\n\t\t\t'adiciona',\r\n\t\t\t'esvazia',\r\n\t\t\t'ordena',\r\n\t\t\t'inverte'\r\n\t\t)\r\n\r\n\t\tthis._mensagem = new Bind(\r\n\t\t\tnew Mensagem(),\r\n\t\t\tnew MensagemView($('#mensagem-view')),\r\n\t\t\t'texto'\r\n\t\t)\r\n\r\n\t\tthis._ordemAtual = '';\r\n\r\n\t\tthis._service = new NegociacaoService();\r\n\r\n\t\tthis._init();\r\n\t}\r\n\r\n\t_init() {\r\n\r\n\t\tthis._service\r\n\t\t\t.lista()\r\n\t\t\t.then(negociacoes => negociacoes.forEach(negociacao =>\r\n\t\t\t\tthis._listaNegociacoes.adiciona(negociacao)\r\n\t\t\t)).catch(erro => this._mensagem.texto = erro)\r\n\r\n\t\tsetInterval(() =>\r\n\t\t\tthis.importaNegociacoes()\r\n\t\t\t, 5000);\r\n\t}\r\n\r\n\tadiciona(event) {\r\n\r\n\t\tevent.preventDefault();\r\n\t\tlet negociacao = this._criaNegociacao();\r\n\r\n\t\tthis._service\r\n\t\t\t.cadastra(negociacao)\r\n\t\t\t.then(mensagem => {\r\n\t\t\t\tthis._listaNegociacoes.adiciona(negociacao);\r\n\t\t\t\tthis._mensagem.texto = mensagem;\r\n\t\t\t\tthis._limpaFormulario();\r\n\t\t\t}).catch(erro => this._mensagem.texto = erro)\r\n\t}\r\n\r\n\timportaNegociacoes() {\r\n\r\n\t\tthis._service\r\n\t\t\t.importa(this._listaNegociacoes.negociacoes)\r\n\t\t\t.then(negociacoes => {\r\n\t\t\t\tnegociacoes.forEach(negociacao => this._listaNegociacoes.adiciona(negociacao));\r\n\t\t\t\tthis._mensagem.texto = 'Negociações importadas com sucesso.';\r\n\t\t\t}).catch(erro => this._mensagem.texto = erro);\r\n\t}\r\n\t\r\n\tapaga() {\r\n\r\n\t\tthis._service\r\n\t\t\t.apaga()\r\n\t\t\t.then(mensagem => {\r\n\t\t\t\tthis._mensagem.texto = mensagem;\r\n\t\t\t\tthis._listaNegociacoes.esvazia();\r\n\t\t\t}).catch(erro => this._mensagem.texto = erro)\r\n\r\n\t}\r\n\r\n\t_criaNegociacao() {\r\n\t\treturn new Negociacao(\r\n\t\t\tDataHelper.textoParaData(this._inputData.value),\r\n\t\t\tparseInt(this._inputQuantidade.value),\r\n\t\t\tparseFloat(this._inputValor.value),\r\n\t\t);\r\n\t}\r\n\r\n\t_limpaFormulario() {\r\n\t\tthis._inputData.value = '';\r\n\t\tthis._inputQuantidade.value = 1;\r\n\t\tthis._inputValor.value = 0.0;\r\n\r\n\t\tthis._inputData.focus();\r\n\t}\r\n\r\n\tordena(coluna) {\r\n\t\tif (coluna === this._ordemAtual) {\r\n\t\t\tthis._listaNegociacoes.inverte();\r\n\t\t} else {\r\n\t\t\tthis._listaNegociacoes.ordena((a, b) => a[coluna] - b[coluna]);\r\n\t\t}\r\n\r\n\t\tthis._ordemAtual = coluna;\r\n\t}\r\n\r\n}\r\n\r\n//ao invés de expotar a classe NegociacaoController, vamos exportar uma instância\r\n//como só terá uma instância dessa classe chamamos esse padrão de Singleton\r\nlet negociacaoController = new NegociacaoController();\r\nexport function currentInstance() {\r\n\r\n    return negociacaoController;\r\n\r\n}"]}