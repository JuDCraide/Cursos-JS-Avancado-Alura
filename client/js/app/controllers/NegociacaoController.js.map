{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["NegociacaoController","$","document","querySelector","bind","_inputData","_inputQuantidade","_inputValor","_listaNegociacoes","Bind","ListaNegociacoes","NegociacoesView","_mensagem","Mensagem","MensagemView","_ordemAtual","_service","NegociacaoService","_init","lista","then","negociacoes","forEach","adiciona","negociacao","catch","texto","erro","setInterval","importaNegociacoes","event","preventDefault","_criaNegociacao","cadastra","mensagem","_limpaFormulario","importa","apaga","esvazia","Negociacao","DataHelper","textoParaData","value","parseInt","parseFloat","focus","coluna","inverte","ordena","a","b"],"mappings":"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","file":"NegociacaoController.js","sourcesContent":["class NegociacaoController {\r\n\r\n\tconstructor() {\r\n\r\n\t\tlet $ = document.querySelector.bind(document);\r\n\r\n\t\tthis._inputData = $('#data');\r\n\t\tthis._inputQuantidade = $('#quantidade');\r\n\t\tthis._inputValor = $('#valor');\r\n\r\n\t\tthis._listaNegociacoes = new Bind(\r\n\t\t\tnew ListaNegociacoes(),\r\n\t\t\tnew NegociacoesView($('#negociacoes-view')),\r\n\t\t\t'adiciona',\r\n\t\t\t'esvazia',\r\n\t\t\t'ordena',\r\n\t\t\t'inverte'\r\n\t\t)\r\n\r\n\t\tthis._mensagem = new Bind(\r\n\t\t\tnew Mensagem(),\r\n\t\t\tnew MensagemView($('#mensagem-view')),\r\n\t\t\t'texto'\r\n\t\t)\r\n\r\n\t\tthis._ordemAtual = '';\r\n\r\n\t\tthis._service = new NegociacaoService();\r\n\r\n\t\tthis._init();\r\n\t}\r\n\r\n\t_init() {\r\n\r\n\t\tthis._service\r\n\t\t\t.lista()\r\n\t\t\t.then(negociacoes => negociacoes.forEach(negociacao =>\r\n\t\t\t\tthis._listaNegociacoes.adiciona(negociacao)\r\n\t\t\t)).catch(erro => this._mensagem.texto = erro)\r\n\r\n\t\tsetInterval(() =>\r\n\t\t\tthis.importaNegociacoes()\r\n\t\t\t, 5000);\r\n\t}\r\n\r\n\tadiciona(event) {\r\n\r\n\t\tevent.preventDefault();\r\n\t\tlet negociacao = this._criaNegociacao();\r\n\r\n\t\tthis._service\r\n\t\t\t.cadastra(negociacao)\r\n\t\t\t.then(mensagem => {\r\n\t\t\t\tthis._listaNegociacoes.adiciona(negociacao);\r\n\t\t\t\tthis._mensagem.texto = mensagem;\r\n\t\t\t\tthis._limpaFormulario();\r\n\t\t\t}).catch(erro => this._mensagem.texto = erro)\r\n\t}\r\n\r\n\timportaNegociacoes() {\r\n\r\n\t\tthis._service\r\n\t\t\t.importa(this._listaNegociacoes.negociacoes)\r\n\t\t\t.then(negociacoes => {\r\n\t\t\t\tnegociacoes.forEach(negociacao => this._listaNegociacoes.adiciona(negociacao));\r\n\t\t\t\tthis._mensagem.texto = 'Negociações importadas com sucesso.';\r\n\t\t\t}).catch(erro => this._mensagem.texto = erro);\r\n\t}\r\n\t\r\n\tapaga() {\r\n\r\n\t\tthis._service\r\n\t\t\t.apaga()\r\n\t\t\t.then(mensagem => {\r\n\t\t\t\tthis._mensagem.texto = mensagem;\r\n\t\t\t\tthis._listaNegociacoes.esvazia();\r\n\t\t\t}).catch(erro => this._mensagem.texto = erro)\r\n\r\n\t}\r\n\r\n\t_criaNegociacao() {\r\n\t\treturn new Negociacao(\r\n\t\t\tDataHelper.textoParaData(this._inputData.value),\r\n\t\t\tparseInt(this._inputQuantidade.value),\r\n\t\t\tparseFloat(this._inputValor.value),\r\n\t\t);\r\n\t}\r\n\r\n\t_limpaFormulario() {\r\n\t\tthis._inputData.value = '';\r\n\t\tthis._inputQuantidade.value = 1;\r\n\t\tthis._inputValor.value = 0.0;\r\n\r\n\t\tthis._inputData.focus();\r\n\t}\r\n\r\n\tordena(coluna) {\r\n\t\tif (coluna === this._ordemAtual) {\r\n\t\t\tthis._listaNegociacoes.inverte();\r\n\t\t} else {\r\n\t\t\tthis._listaNegociacoes.ordena((a, b) => a[coluna] - b[coluna]);\r\n\t\t}\r\n\r\n\t\tthis._ordemAtual = coluna;\r\n\t}\r\n}"]}